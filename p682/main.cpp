#include <iostream>
#include <vector>
#include <stack>

using namespace std;

#define debug(x) cout<<#x<<": "<<x<<endl;

class Solution {
public:
    int str_int(string s){
        /*
        int pos = 0;
        bool fu = 0;
        if( s[0]=='-' ){
            pos = 1;
            fu = 1;
        }
        int ret = 0;
        for( ; pos < s.size();pos++){
            ret *= 10;
            ret += s[pos] -'0';
        }
        if( fu ){
            ret = -ret;
        }
        return ret;
        */
        stringstream ss;
        ss<<s;
        int ret;
        ss>>ret;
        return ret;

    }
    int calPoints(vector<string>& ops) {
        stack<int> st;

        int ret = 0;
        for(int i = 0;i < ops.size();i ++){
            if( ops[i] == "C" ){
                ret -= st.top();
                st.pop();
            }else if( ops[i] == "D" ){
                ret += st.top()*2;
                st.push( st.top()*2 );
            }else if( ops[i] == "+" ){
                int pre = st.top();
                ret += pre;
                st.pop();
                int ppre = st.top();
                ret += ppre;
                st.push( pre );
                st.push( pre + ppre);
            }else{
                ret += str_int( ops[i] );
                st.push( str_int( ops[i] ) );
            }
            //debug( ops[i] )
            //debug(ret)
        }
        return ret;
    }
};

int main()
{
    Solution Solution1;
    vector<string> ops = {"-27276","D","+","+","C","D","+","-12178","+","+","-20323","-7421","+","C","-10993","+","-9879","-14593","D","8677","C","-17939","17437","-2684","-23038","D","D","-4392","+","C","+","-4750","6731","D","21137","D","-16560","-20500","D","+","1861","C","-2627","C","D","12210","C","-19271","-9873","-18831","-20978","+","4228","559","-24728","+","-7746","-6307","23606","C","26513","D","13166","+","26096","D","-14110","15671","9599","-21122","+","-5263","+","C","+","C","9395","14881","2429","D","C","D","C","+","C","7876","+","C","14808","-9801","-16149","D","-4979","-4227","C","C","+","-12441","-13190","D","C","25907","810","C","D","28586","-12823","D","D","6482","D","-85","-519","+","D","12750","4140","+","C","-4366","D","+","20343","+","+","20059","+","D","-13480","D","-24672","D","C","2865","+","C","C","+","+","C","-8555","-22539","-15141","-22613","23415","D","19591","6585","C","18754","25246","-25166","C","15185","D","+","-9715","-2997","-4851","-5425","-28275","12429","23908","-11980","22831","1041","+","D","C","D","-5400","+","-14046","-23895","C","11968","D","D","-2228","C","-27389","+","+","-20200","D","C","28942","-23540","D","-9557","-24297","-9587","-29781","D","C","21967","D","+","+","-7065"};
     //{"5","-2","4","C","D","9","+","+","+"};
    cout << Solution1.calPoints(ops) << endl;
    return 0;
}
